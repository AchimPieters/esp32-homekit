cmake_minimum_required(VERSION 3.5)

set(LED_TARGET "${IDF_TARGET}")
if(NOT LED_TARGET)
  set(LED_TARGET "esp32")
endif()

set(LED_PARTITION_TABLE "")
if(LED_TARGET STREQUAL "esp32")
  set(LED_PARTITION_TABLE "partitions/partitions_esp32.csv")
elseif(LED_TARGET STREQUAL "esp32s2")
  set(LED_PARTITION_TABLE "partitions/partitions_esp32s2.csv")
elseif(LED_TARGET STREQUAL "esp32c3")
  set(LED_PARTITION_TABLE "partitions/partitions_esp32c3.csv")
elseif(LED_TARGET STREQUAL "esp32s3")
  set(LED_PARTITION_TABLE "partitions/partitions_esp32s3.csv")
elseif(LED_TARGET STREQUAL "esp32c2")
  set(LED_PARTITION_TABLE "partitions/partitions_esp32c2.csv")
elseif(LED_TARGET STREQUAL "esp32c6")
  set(LED_PARTITION_TABLE "partitions/partitions_esp32c6.csv")
elseif(LED_TARGET STREQUAL "esp32c5")
  set(LED_PARTITION_TABLE "partitions/partitions_esp32c5.csv")
else()
  message(FATAL_ERROR "Unsupported IDF_TARGET '${LED_TARGET}' for examples/led. Add matching sdkconfig.defaults and partitions file.")
endif()

set(LED_PARTITION_TABLE_PATH "${CMAKE_CURRENT_LIST_DIR}/${LED_PARTITION_TABLE}")
if(NOT EXISTS "${LED_PARTITION_TABLE_PATH}")
  message(FATAL_ERROR "Partition table file not found: ${LED_PARTITION_TABLE_PATH}")
endif()

set(PARTITION_TABLE_DEFAULT "${LED_PARTITION_TABLE}" CACHE FILEPATH "Default partition table file")
message(STATUS "Configuring for ESP32 variant: ${LED_TARGET}")
message(STATUS "Partition table file: ${PARTITION_TABLE_DEFAULT}")

include($ENV{IDF_PATH}/tools/cmake/project.cmake)
project(main)
